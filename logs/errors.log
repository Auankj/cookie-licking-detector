{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:28.156838+00:00", "@timestamp": "2025-11-05 22:29:28,156", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 104, in list_claims\n    count_result = await db.execute(count_stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:28.202339+00:00", "@timestamp": "2025-11-05 22:29:28,202", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 159, in get_claim_details\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:28.230210+00:00", "@timestamp": "2025-11-05 22:29:28,230", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:55.724266+00:00", "@timestamp": "2025-11-05 22:29:55,724", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 104, in list_claims\n    count_result = await db.execute(count_stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:55.743379+00:00", "@timestamp": "2025-11-05 22:29:55,743", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 159, in get_claim_details\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T16:59:55.757369+00:00", "@timestamp": "2025-11-05 22:29:55,757", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:09.494783+00:00", "@timestamp": "2025-11-05 22:39:09,494", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 104, in list_claims\n    count_result = await db.execute(count_stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:09.537506+00:00", "@timestamp": "2025-11-05 22:39:09,537", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 159, in get_claim_details\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:09.565801+00:00", "@timestamp": "2025-11-05 22:39:09,565", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:23.941636+00:00", "@timestamp": "2025-11-05 22:39:23,941", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 104, in list_claims\n    count_result = await db.execute(count_stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:23.958435+00:00", "@timestamp": "2025-11-05 22:39:23,958", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 159, in get_claim_details\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:09:23.972571+00:00", "@timestamp": "2025-11-05 22:39:23,972", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:18:25.341393+00:00", "@timestamp": "2025-11-05 22:48:25,341", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 104, in list_claims\n    count_result = await db.execute(count_stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT count(claims.id) AS count_1 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:18:25.386116+00:00", "@timestamp": "2025-11-05 22:48:25,386", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/claim_routes.py\", line 159, in get_claim_details\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table claims\n[SQL: SELECT claims.id, claims.issue_id, claims.repository_id, claims.user_id, claims.github_user_id, claims.github_username, claims.claim_comment_id, claims.claim_text, claims.claim_timestamp, claims.status, claims.first_nudge_sent_at, claims.last_activity_timestamp, claims.auto_release_timestamp, claims.release_reason, claims.confidence_score, claims.context_metadata, claims.created_at, claims.updated_at, issues.id AS id_1, issues.repository_id AS repository_id_1, issues.github_repo_id, issues.github_issue_id, issues.github_issue_number, issues.title, issues.description, issues.status AS status_1, issues.created_at AS created_at_1, issues.updated_at AS updated_at_1, issues.github_data, repositories.id AS id_2, repositories.github_repo_id AS github_repo_id_1, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at AS created_at_2, repositories.updated_at AS updated_at_2 \nFROM claims JOIN issues ON claims.issue_id = issues.id JOIN repositories ON issues.repository_id = repositories.id \nWHERE claims.id = $1::INTEGER]\n[parameters: (1,)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:18:25.413844+00:00", "@timestamp": "2025-11-05 22:48:25,413", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
{"hostname": "unknown", "service": "cookie-licking-detector", "environment": "development", "message": "Internal server error: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "exc_info": "Traceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 557, in _prepare_and_execute\n    self._rows = await prepared_stmt.fetch(*parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 176, in fetch\n    data = await self.__bind_execute(args, 0, timeout)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 241, in __bind_execute\n    data, status, _ = await self.__do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/asyncpg/prepared_stmt.py\", line 230, in __do_execute\n    return await executor(protocol)\n  File \"asyncpg/protocol/protocol.pyx\", line 207, in bind_execute\nasyncpg.exceptions.InsufficientPrivilegeError: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.dialects.postgresql.asyncpg.AsyncAdapt_asyncpg_dbapi.ProgrammingError: <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/errors.py\", line 162, in __call__\n    await self.app(scope, receive, _send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 173, in metrics_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 108, in __call__\n    response = await self.dispatch_func(request, call_next)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/main.py\", line 164, in security_headers_middleware\n    response = await call_next(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 84, in call_next\n    raise app_exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/base.py\", line 70, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/cors.py\", line 83, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 79, in __call__\n    raise exc\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/middleware/exceptions.py\", line 68, in __call__\n    await self.app(scope, receive, sender)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 20, in __call__\n    raise e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/middleware/asyncexitstack.py\", line 17, in __call__\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 718, in __call__\n    await route.handle(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 276, in handle\n    await self.app(scope, receive, send)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/starlette/routing.py\", line 66, in app\n    response = await func(request)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 274, in app\n    raw_response = await run_endpoint_function(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/fastapi/routing.py\", line 191, in run_endpoint_function\n    return await dependant.call(**values)\n  File \"/Users/void/Desktop/CookiesCop/cookie-licking-detector/app/api/repository_routes.py\", line 146, in list_repositories\n    result = await db.execute(stmt)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/ext/asyncio/session.py\", line 455, in execute\n    result = await greenlet_spawn(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 190, in greenlet_spawn\n    result = context.throw(*sys.exc_info())\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2308, in execute\n    return self._execute_internal(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/session.py\", line 2190, in _execute_internal\n    result: Result[Any] = compile_state_cls.orm_execute_statement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/orm/context.py\", line 293, in orm_execute_statement\n    result = conn.execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1416, in execute\n    return meth(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/sql/elements.py\", line 516, in _execute_on_connection\n    return connection._execute_clauseelement(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_clauseelement\n    ret = self._execute_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1848, in _execute_context\n    return self._exec_single_context(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1988, in _exec_single_context\n    self._handle_dbapi_exception(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 2343, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/base.py\", line 1969, in _exec_single_context\n    self.dialect.do_execute(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/engine/default.py\", line 922, in do_execute\n    cursor.execute(statement, parameters)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 591, in execute\n    self._adapt_connection.await_(\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 125, in await_only\n    return current.driver.switch(awaitable)  # type: ignore[no-any-return]\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/util/_concurrency_py3k.py\", line 185, in greenlet_spawn\n    value = await result\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 569, in _prepare_and_execute\n    self._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 520, in _handle_exception\n    self._adapt_connection._handle_exception(error)\n  File \"/Users/void/Library/Python/3.9/lib/python/site-packages/sqlalchemy/dialects/postgresql/asyncpg.py\", line 808, in _handle_exception\n    raise translated_error from error\nsqlalchemy.exc.ProgrammingError: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.InsufficientPrivilegeError'>: permission denied for table repositories\n[SQL: SELECT repositories.id, repositories.github_repo_id, repositories.owner_id, repositories.owner_name, repositories.name, repositories.full_name, repositories.url, repositories.is_monitored, repositories.grace_period_days, repositories.nudge_count, repositories.notification_settings, repositories.claim_detection_threshold, repositories.created_at, repositories.updated_at \nFROM repositories \n LIMIT $1::INTEGER OFFSET $2::INTEGER]\n[parameters: (100, 0)]\n(Background on this error at: https://sqlalche.me/e/20/f405)", "timestamp": "2025-11-05T17:19:20.628592+00:00", "@timestamp": "2025-11-05 22:49:20,628", "level": "ERROR", "logger": "app.main", "file": "main.py", "line": 591, "function": "internal_error_handler"}
